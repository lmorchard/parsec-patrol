function Base(e){var t=this,n=this.stats={suites:0,tests:0,passes:0,pending:0,failures:0},r=this.failures=[];if(!e)return;this.runner=e,e.stats=n,e.on("start",function(){n.start=new Date}),e.on("suite",function(e){n.suites=n.suites||0,e.root||n.suites++}),e.on("test end",function(e){n.tests=n.tests||0,n.tests++}),e.on("pass",function(e){n.passes=n.passes||0;var t=e.slow()/2;e.speed=e.duration>e.slow()?"slow":e.duration>t?"medium":"fast",n.passes++}),e.on("fail",function(e,t){n.failures=n.failures||0,n.failures++,e.err=t,r.push(e)}),e.on("end",function(){n.end=new Date,n.duration=new Date-n.start}),e.on("pending",function(){n.pending++})}function pad(e,t){return e=String(e),Array(t-e.length+1).join(" ")+e}function errorDiff(e,t,n){return diff["diff"+t](e.actual,e.expected).map(function(e){return n&&(e.value=e.value.replace(/\t/g,"<tab>").replace(/\r/g,"<CR>").replace(/\n/g,"<LF>\n")),e.added?colorLines("diff added",e.value):e.removed?colorLines("diff removed",e.value):e.value}).join("")}function colorLines(e,t){return t.split("\n").map(function(t){return color(e,t)}).join("\n")}var tty=require("tty"),diff=require("diff"),ms=require("../ms"),Date=global.Date,setTimeout=global.setTimeout,setInterval=global.setInterval,clearTimeout=global.clearTimeout,clearInterval=global.clearInterval,isatty=tty.isatty(1)&&tty.isatty(2);exports=module.exports=Base,exports.useColors=isatty,exports.colors={pass:90,fail:31,"bright pass":92,"bright fail":91,"bright yellow":93,pending:36,suite:0,"error title":0,"error message":31,"error stack":90,checkmark:32,fast:90,medium:33,slow:31,green:32,light:90,"diff gutter":90,"diff added":42,"diff removed":41},exports.symbols={ok:"âœ“",err:"âœ–",dot:"â€¤"},"win32"==process.platform&&(exports.symbols.ok="âˆš",exports.symbols.err="Ã—",exports.symbols.dot=".");var color=exports.color=function(e,t){return exports.useColors?"["+exports.colors[e]+"m"+t+"[0m":t};exports.window={width:isatty?process.stdout.getWindowSize?process.stdout.getWindowSize(1)[0]:tty.getWindowSize()[1]:75},exports.cursor={hide:function(){process.stdout.write("[?25l")},show:function(){process.stdout.write("[?25h")},deleteLine:function(){process.stdout.write("[2K")},beginningOfLine:function(){process.stdout.write("[0G")},CR:function(){exports.cursor.deleteLine(),exports.cursor.beginningOfLine()}},exports.list=function(e){console.error(),e.forEach(function(e,t){var n=color("error title","  %s) %s:\n")+color("error message","     %s")+color("error stack","\n%s\n"),r=e.err,i=r.message||"",s=r.stack||i,o=s.indexOf(i)+i.length,u=s.slice(0,o),a=r.actual,f=r.expected,l=!0;r.showDiff&&(l=!1,r.actual=a=JSON.stringify(a,null,2),r.expected=f=JSON.stringify(f,null,2));if("string"==typeof a&&"string"==typeof f){var c=Math.max(a.length,f.length);c<20?u=errorDiff(r,"Chars",l):u=errorDiff(r,"Words",l);var h=u.split("\n");if(h.length>4){var p=String(h.length).length;u=h.map(function(e,t){return pad(++t,p)+" |"+" "+e}).join("\n")}u="\n"+color("diff removed","actual")+" "+color("diff added","expected")+"\n\n"+u+"\n",u=u.replace(/^/gm,"      "),n=color("error title","  %s) %s:\n%s")+color("error stack","\n%s\n")}s=s.slice(o?o+1:o).replace(/^/gm,"  "),console.error(n,t+1,e.fullTitle(),u,s)})},Base.prototype.epilogue=function(){function r(e){return 1==e?"test":"tests"}var e=this.stats,t,n;console.log();if(e.failures){t=color("bright fail","  "+exports.symbols.err)+color("fail"," %d of %d %s failed")+color("light",":"),console.error(t,e.failures,this.runner.total,r(this.runner.total)),Base.list(this.failures),console.error();return}t=color("bright pass"," ")+color("green"," %d %s complete")+color("light"," (%s)"),console.log(t,e.tests||0,r(e.tests),ms(e.duration)),e.pending&&(t=color("pending"," ")+color("pending"," %d %s pending"),console.log(t,e.pending,r(e.pending))),console.log()};